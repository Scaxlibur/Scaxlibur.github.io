---
title: 软路由入门指南
date: 2024-11-09
category:
  - 软路由
tag:
  - 折腾
order: -1
---

## 什么是软路由？

软路由是指利用台式机或服务器的供应商配合一定软件而形成的路由解决方案，主要靠对软件的设置，实现路由器的功能，它的软件与硬件是独立分开的。软路由使用普通计算机，使用通用的操作系统，如Linux或windows，因此软路由的设置事实上是windows或linux的设置。根据使用的操作系统不同，可以分为基于windows平台和基于Linux/bsd平台开发的软件路由器。

软路由之所以叫软路由，就是为了和硬路由进行区分。硬路由有专用的包转发硬件设计，所以性能会优于软路由。虽然软路由使用软件实现包转发，但开放的生态和较强的硬件性能，或许可以实现“力大砖飞”的效果。

## 软路由能做什么？

除了最基本的路由功能以外，软路由还有其他极其丰富的功能，这些功能均由软路由所安装的软件包决定。如`home assistant 家庭物联网关`、`广告拦截`、`smartDNS`等功能。

::: warning
有些功能可能违反相关法律，使用时请注意。
:::

## 软路由的实现方式

|主路由：一般有2个或以上网口，一个设置成wan口一个设置为lan口。                                    |
|--------------------------------------------------------------------------------------------|
|优点：操作比较简单，无需设置，设备全自动接入主路由。逻辑和普通路由器无异                           |
|缺点：软路由出故障，整个环境不能上网。                                                          |

|单臂路由：也是一种特殊的主路由，只有一个网口，既当wan口又当lan口使用。                            |
|--------------------------------------------------------------------------------------------|
|优点：实现不同vlan之间的通信，有助理解、学习VLAN原理和子接口概念。节省硬件资源                    |
|缺点：逻辑不好理解，可能会比较错乱                                                             |

|旁路由：一般只有1个网口，需要设置客户端的网关和DNS为旁路由的ip地址。                             |
|--------------------------------------------------------------------------------------------|
|优点：非侵入式、保持原先整个网络架构，按需接入客户端，旁路由故障，不会影响未设置网关为旁路由的客户端 |
|缺点：需要手动设置客户端（手机、电脑）等设备的网关和DNS，比较麻烦                                |

## 软路由需要怎样的配置？

和硬路由需要专门的路由器不同，软路由几乎没有硬件上的硬性要求————只要不是太差都可以，你甚至可以在树莓派上运行软路由系统。正因如此，笔者选择在hyper-V虚拟机上运行软路由系统。

但是虚拟机总是需要实机承载，所以以下是笔者实体机的配置。

|  硬件   |         型号         |
| ------- |    -------------    |
|  CPU    |Intel Xeon E3-1230 v3|
|  内存   |     16 GB DDR3      |
|  硬盘   |     2TB HDD         |
|  网卡1  |    板载1G网卡        |
|  网卡2  |    螃蟹2.5G网卡      |
|  网卡3  |    螃蟹2.5G网卡      |

 !!其实就是洋垃圾经典配置啦（心虚）!!

实际上笔者也折腾黑群晖NAS，但我并不推荐**All in One**的部署方式。软路由当然可以部署到NAS的虚拟机平台中。但一方面，软路由使用CPU进行软件层面的包转发，这对NAS孱弱的CPU性能而言算是不小的挑战。

因此，笔者建议使用一台二手工控机，或者在性能一般的电脑上运行虚拟机。这是平衡功耗和开销的最佳选择。

## 软路由需要什么软件？

软路由实际上就是一种操作系统。软路由操作系统有很多，但对于笔者这样的纯折腾用户，推荐使用OpenWRT。

OpenWRT有很多个版本，就好像Linux有多个发行版。一般来说，比较高级的玩家一般会自己编译OpenWRT，并且在编译的过程中加入一些自己喜欢的插件。但笔者比较菜，又不喜欢用其他大佬编译好的系统。所以笔者会使用 [OpenWrt固件下载与在线定制](https://openwrt.ai/?target=x86%2F64&id=generic) 这样可以自选的在线编译网站进行编译。~以后笔者也会试着自己编译，有机会再更新~
